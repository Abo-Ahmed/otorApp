VERSION 5.00
Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} UserForm1 
   Caption         =   "«ћ«“…"
   ClientHeight    =   6828
   ClientLeft      =   108
   ClientTop       =   456
   ClientWidth     =   13872
   OleObjectBlob   =   "UserForm1.frx":0000
   StartUpPosition =   1  'CenterOwner
End
Attribute VB_Name = "UserForm1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

Dim db_object As DAO.Database
Dim rst_object As DAO.Recordset
Dim wdApp As Word.Application
Dim database_path As String

Private Sub CommandButton9_Click()
    replace_text original_text:="у", new_text:=""
    replace_text original_text:="р", new_text:=""
    replace_text original_text:="х", new_text:=""
    replace_text original_text:="с", new_text:=""
    replace_text original_text:="ц", new_text:=""
    replace_text original_text:="т", new_text:=""
    replace_text original_text:="ъ", new_text:=""
    replace_text original_text:="ш", new_text:=""

End Sub

Private Sub UserForm_Initialize()
   database_path = "E:\sanad\otor_be.accdb"
   'On Error GoTo rapid:
   Set db_object = OpenDatabase(database_path)
   Set rst_object = db_object.OpenRecordset("Select ID , SHEIKH_NAME , DEGREE from  [ORDER] WHERE STATE NOT IN ( 'NEXT' ) ORDER BY DEGREE")
   Do Until rst_object.EOF
     ComboBox1.AddItem (rst_object.Fields("ID") & "-" & rst_object.Fields("SHEIKH_NAME"))
     rst_object.MoveNext
   Loop
    
rapid:
    ' make numbers arabic
    Options.ArabicNumeral = wdNumeralHindi
   
End Sub

Public Function replace_text(original_text As String, new_text As String)
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .text = original_text
        .Replacement.text = new_text
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchKashida = False
        .MatchDiacritics = False
        .MatchAlefHamza = False
        .MatchControl = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
End Function

Private Sub set_names()
    replace_text original_text:="sheikh_name", new_text:=TextBox1.text
    replace_text original_text:="sheikh_info", new_text:=TextBox3.text
    replace_text original_text:="student_name", new_text:=TextBox2.text
    replace_text original_text:="student_info", new_text:=TextBox4.text
End Sub
Private Sub set_sheikh_type(sheikh_type)
    If sheikh_type = False Then
        replace_text original_text:="mogez", new_text:="«б‘нќ…"
        replace_text original_text:="Ёнёжб «б‘нќ…", new_text:="Ё ёжб «б‘нќ…"
    Else
        replace_text original_text:="mogez", new_text:="«б‘нќ"
    End If
End Sub
    
Private Sub set_student_type(student_type As Boolean)
   
' set student type
    If student_type = False Then
            
            replace_text original_text:="бцгх”ъ уЌуёшцеу« «бгхћу«“", new_text:="бцгх”ъ уЌуё еу« «бгхћу«“…"
            replace_text original_text:="«”г «бЎ«б» ед«", new_text:="«”г «бЎ«б»… ед«"
            replace_text original_text:="дЁЏ «ббе »е жЏуЁу« Џудъех жуЏудъ жу«бцѕунъец жу‘хнхжќце жу«бъгх”ъбцгцнду", new_text:="дЁЏ «ббе »е« жЏуЁу« Џудъе« жуЏудъ жу«бцѕунъе« жу‘хнхжќце« жу«бъгх”ъбцгцнду"
            replace_text original_text:="«бЏугцнёц «бЎ«бц»х «бгхћу«“х /", new_text:="«бЏугцнёц «бЎ«бц»… «бгхћу«“… /"
            replace_text original_text:="буёуѕъ ёу—у√у Џубуншу «бёх—ъ¬ду «бяу—цнгу", new_text:="буёуѕъ ёу—у√у  Џубуншу «бёх—ъ¬ду «бяу—цнгу"
            replace_text original_text:="жу»уЏъѕ √удъ Џубцгу х гцдъех «бѕшц—у«ну…ц жу«б≈ц ъёу«дц жу √Ўъгу√ъдудъ х ≈цбум ёц—у«Ѕу цец яхбшу «б≈Ўъгц∆ъду«д", new_text:="жу»уЏъѕ √удъ Џубцгу х гцдъе« «бѕшц—у«ну…ц жу«б≈ц ъёу«дц жу √Ўъгу√ъдудъ х ≈цбум ёц—у«Ѕу це« яхбшу «б«Ўъгц∆ъду«дц"
            replace_text original_text:="жу ёѕ Ўубу»у гцдум «б≈цћу«“у…у жу яц у«»у…у «б”шудуѕц Ёу√ућу“ъ хех »ц«бёц—у«Ѕу…", new_text:="жу ёѕ Ўубу»  гцдум «б≈цћу«“у…у жу яц у«»у…у «б”шудуѕц Ёу√ућу“ъ хе« »ц«бёц—у«Ѕу…"
            replace_text original_text:="бцяужъдцец √уеъб«р б–убцяу жу√у–цдъ х буех √удъ нуёъ—у√у жнхёъ—ц∆ жунхЏубшцгх жунхћцн“х џунъ—уех »цгу« ёу—у√у Џубуншу Ёцн √уншц гуяу«д", new_text:="бцяужъдце« √уеъб«р б–убцяу жу√у–цдъ х буе« √удъ  ёъ—у√у ж ёъ—ц∆ жу  Џубшцгх жу  ћцн“х џунъ—уе« »цгу« ёу—у√у  Џубуншу Ёцн √уншц гуяу«д"
            replace_text original_text:="Ќубшт жу Ёшум √уншц ёхЎъ— ду“убу »ц‘у—ъЎц «бъ√угу«ду…ц жу «б’шцну«ду…ц жу«бъгхЎу«буЏу…ц жу√убу« нуёхжбу ≈цбу« »цгу« нуЏъбугх Ёу≈цдъ »уѕшубу √ужъџуншу—у √жу ÷уншуЏу «бёх—ъ¬д", new_text:="Ќубшт  жу Ёшум √уншц ёхЎъ— ду“убу  »ц‘у—ъЎц «бъ√угу«ду…ц жу «б’шцну«ду…ц жу«бъгхЎу«буЏу…ц жу√убу«  ёхжбу ≈цбу« »цгу«  Џъбугх Ёу≈цдъ »уѕшубу  √ужъ џуншу—у  √жу ÷уншуЏу  «бёх—ъ¬ду"
            replace_text original_text:="жуёуЏу Ёцн «ббшуЌъд", new_text:="жёЏ  Ём «ббЌд"
            replace_text original_text:="жуёуѕъ Ўубу»у гцдшцм гуЏъ—цЁу…у ≈ц”ъду«ѕцм Ёцн «бёх—ъ¬дц «бяу—цнгц Ёу√ућу»ъ хех жу√уќъ»у—ъ хе", new_text:="жуёуѕъ Ўубу»у  гцдшцм гуЏъ—цЁу…у ≈ц”ъду«ѕцм Ёцн «бёх—ъ¬дц «бяу—цнгц Ёу√ућу»ъ хе« жу√уќъ»у—ъ хе«"
            replace_text original_text:="«б‘нќ «бгћ«“ / ", new_text:="«б‘нќ… «бгћ«“… / "
            replace_text original_text:="еу–у« жу√хж’цн дуЁъ”цн жу «бгхћу«“у", new_text:="еу–у« жу√хж’цн дуЁъ”цн жу «бгхћу«“…"
            replace_text original_text:="бцнуЏъ—цЁу ёуѕъ—у гу« жу’убу ≈цбунъец жу √хџъѕцёу Џубунъец гудъ еу–цец «бдшцЏъгу…ц «бЏуўцнгу…ц жу «бгцдшу…ц «бћу”цнгу…ц жу бцнхЏубшцг", new_text:="бц Џъ—цЁу ёуѕъ—у гу« жу’убу  ≈цбунъец жу √хџъѕцё Џубунъе« гудъ еу–цец «бдшцЏъгу…ц «бЏуўцнгу…ц жу «бгцдшу…ц «бћу”цнгу…ц жу бц Џубшцг"
            replace_text original_text:="ќу«Ёц÷р« ћуду«Ќуех бцяхбшц гудъ √х у«ех жубу« нуёъ у’у— Џубум гу« Џцдъѕуех жуну ъ—хя «бћцѕшу", new_text:="ќу«Ёц÷… ћуду«Ќуе« бцяхбшц гудъ √х у«е« жубу«  ёъ у’у— Џубум гу« Џцдъѕуе« жу  ъ—хя «бћцѕшу"
            replace_text original_text:="жбну“цѕе «бЏцбъгу гуЌу«”цду", new_text:="жбну“цѕе« «бЏцбъгу гуЌу«”цду"
            replace_text original_text:="жу ≈цдшцм ёуѕъ √ућу“ъ хяу √уне« «бЎшу«бц»", new_text:="жу ≈цдшцм ёуѕъ √ућу“ъ хяц √ун е« «бЎшу«бц»…"
            replace_text original_text:="ЁуЌу«Ёцўх √цне «бгхћу«“х Џубум гу« √уѕшунъ хех буяу ћуЏубуя", new_text:="ЁуЌу«Ёцўн √цн е« «бгхћу«“… Џубум гу« √уѕшунъ хех буяу ћуЏубуя"
            replace_text original_text:=" жу√хж’цнец √убу« нудъ”у«дцн жу√уеъбцн жу–у—шцншу цн гцдъ ’у«бцЌц ѕуЏужу« цец Ёцн ќубужу« цец жћубужу« цец жу√удъ ну–ъях—удцн Џцдъѕу —у»шце.", new_text:=" жу√хж’цне« √убу«  дъ”у«дцн жу√уеъбцн жу–у—шцншу цн гцдъ ’у«бцЌц ѕуЏужу« це« Ёцн ќубужу« це« жћубужу« це« жу√удъ  –ъях—удцн Џцдъѕу —у»шце«."
                 
    End If

End Sub

Private Sub update_sheikh_student(sheikh_type As Boolean, student_type As Boolean)
        set_names
        set_sheikh_type sheikh_type:=sheikh_type
        set_student_type student_type:=student_type
End Sub
Private Function set_qeraat(STATE As String, qeraat As String, rawy As String)
    replace_text original_text:="egaza_content", new_text:=qeraat
    replace_text original_text:="rawy", new_text:=rawy
    replace_text original_text:="egaza_state", new_text:=STATE
End Function
Private Sub set_snada(sanada)
 
   Dim index As Integer
   index = 0
   Do While index < 20
        On Error GoTo wow:
            replace_text original_text:="sanada", new_text:=Left(sanada, 200) & "sanada"
            index = index + 1
            sanada = Replace(sanada, Left(sanada, 200), "")
Loop
wow:
           replace_text original_text:="sanada", new_text:=""
End Sub
Function sanadan(index As Integer) As String
   On Error GoTo runner:
    sanadan = db_object.OpenRecordset("Select DETAILS from SANAD WHERE QERAAT = '" & isnad(index) & "'").Fields("DETAILS")
runner:
End Function
Function qeraatn(index As Integer) As String

        'adding sanad
        qeraatn = "egaza_content"
        If index = -1 Then qeraatn = "»ё—«Ѕ«  √еб «б ж”Ў ( «»д Џ«г— ж Џ«’г ж «бя”«∆м ж ќбЁ )"
        If index = -2 Then qeraatn = "»ё—Ѕ«… «б»’—н«д ( √»ж Џг—ж ж нЏёж» ) "
        If index = -3 Then qeraatn = "»«бё—«Ѕ«  «бЏ‘— «б’џ—м"
        If index = -4 Then qeraatn = "»ё—«Ѕ«  √еб «б’б…"
        If index = -5 Then qeraatn = "»«бё—«Ѕ«  «б”»Џ"
        If index = 1 Then qeraatn = "»ё—«Ѕ… «б≈г«г д«ЁЏ »—«жнне"
        If index = 3 Then qeraatn = "»ё—«Ѕ… «б≈г«г √»ж Џг—ж «б»’—м »—«жнне"
        If index = 4 Then qeraatn = "»ё—«Ѕ… «б≈г«г «»д Џ«г— »—«жнне"
        If index = 5 Then qeraatn = "»ё—«Ѕ… «б≈г«г Џ«’г »—«жнне"
        If index = 6 Then qeraatn = "»ё—«Ѕ… «б≈г«г Ќг“… »—«жнне"
        If index = 7 Then qeraatn = "»ё—«Ѕ… «б≈г«г «бя”«∆м »—«жнне"
        If index = 8 Then qeraatn = "»ё—«Ѕ… «б≈г«г √»ж ћЏЁ— »—«жнне"
        If index = 9 Then qeraatn = "»ё—«Ѕ… «б≈г«г нЏёж» »—«жнне"
        If index = 10 Then qeraatn = "»ё—«Ѕ… «б≈г«г ќбЁ «б»“«— »—«жнне"
        If index = 11 Then qeraatn = "»—ж«н… ж—‘ Џд д«ЁЏ"
        If index = 21 Then qeraatn = "»—ж«н… ёд»б Џд «»д яЋн—"
        If index = 31 Then qeraatn = "»—ж«н… «б”ж”м Џд √»ж Џг—ж «б»’—м"
        If index = 41 Then qeraatn = "»—«жн… «»д –яж«д Џд «»д Џ«г—"
        If index = 51 Then qeraatn = "»—ж«н… ЌЁ’ Џд Џ«’г"
        If index = 61 Then qeraatn = "»—ж«н… ќб«ѕ Џд Ќг“…"
        If index = 71 Then qeraatn = "»—ж«н… √»м «бЌ«—Ћ Џд «бя”«∆м"
        If index = 81 Then qeraatn = "»—ж«н… «»д ћг«“ Џд √»м ћЏЁ—"
        If index = 91 Then qeraatn = "»—ж«н… —жЌ Џд нЏёж»"
        If index = 101 Then qeraatn = "»—ж«н… ≈ѕ—н” Џд ќбЁ «б»“«—"
        If index = 12 Then qeraatn = "»—ж«н… ё«бжд Џд д«ЁЏ"
        If index = 22 Then qeraatn = "»—ж«н… «б»“м Џд «»д яЋн—"
        If index = 32 Then qeraatn = "»—ж«н… «бѕж—м Џд √»ж Џг—ж «б»’—м"
        If index = 42 Then qeraatn = "»—ж«н… е‘«г Џд «»д Џ«г—"
        If index = 52 Then qeraatn = "»—ж«н… ‘Џ»… Џд Џ«’г"
        If index = 62 Then qeraatn = "»—ж«н… ќбЁ Џд Ќг“…"
        If index = 72 Then qeraatn = "»—ж«н… √»ж Џг—ж «бѕж—м Џд «бя”«∆м"
        If index = 82 Then qeraatn = "»—ж«н… «»д ж—ѕ«д Џд √»м ћЏЁ—"
        If index = 92 Then qeraatn = "»—ж«н… —жн” Џд нЏёж»"
        If index = 102 Then qeraatn = "»—ж«н… «бж—«ё Џд ќбЁ «б»“«—"

End Function
Function isnad(index As Integer) As String

        isnad = "egaza_content"
        'adding sanad
        If index = -1 Then isnad = "«еб «б ж”Ў"
        If index = -2 Then isnad = "«б»’—н«д"
        If index = -3 Then isnad = "«бЏ‘—"
        If index = -4 Then isnad = "«еб «б’б…"
        If index = -5 Then isnad = "«б”»Џ"
        If index = 1 Then isnad = "д«ЁЏ"
        If index = 2 Then isnad = "«»д яЋн—"
        If index = 3 Then isnad = "«»ж Џг—ж «б»’—м"
        If index = 4 Then isnad = "«»д Џ«г—"
        If index = 5 Then isnad = "Џ«’г"
        If index = 6 Then isnad = "Ќг“…"
        If index = 7 Then isnad = "«бя”«∆м"
        If index = 8 Then isnad = "«»ж ћЏЁ—"
        If index = 9 Then isnad = "нЏёж»"
        If index = 10 Then isnad = "ќбЁ «б»“«—"
        If index = 11 Then isnad = "ж—‘"
        If index = 21 Then isnad = "ёд»б"
        If index = 31 Then isnad = "«б”ж”м"
        If index = 41 Then isnad = "«»д –яж«д"
        If index = 51 Then isnad = "ЌЁ’"
        If index = 61 Then isnad = "ќб«ѕ"
        If index = 71 Then isnad = "«»м «бЌ«—Ћ"
        If index = 81 Then isnad = "«»д ћг«“"
        If index = 91 Then isnad = "—жЌ"
        If index = 101 Then isnad = "≈ѕ—н”"
        If index = 12 Then isnad = "ё«бжд"
        If index = 22 Then isnad = "«б»“м"
        If index = 32 Then isnad = "«бѕж—м"
        If index = 42 Then isnad = "е‘«г"
        If index = 52 Then isnad = "‘Џ»…"
        If index = 62 Then isnad = "ќбЁ"
        If index = 72 Then isnad = "«»ж Џг—ж «бѕж—м"
        If index = 82 Then isnad = "«»д ж—ѕ«д"
        If index = 92 Then isnad = "—жн”"
        If index = 102 Then isnad = "«бж—«ё"

End Function

Public Function rawye(index As Integer) As String

        rawye = "rawy"
     'adding sanad
        If index = -1 Then rawye = "”дѕ ё—«Ѕ«  / √еб «б ж”Ў"
        If index = -2 Then rawye = "”дѕ ё—«Ѕ«  / «б»’—н«д"
        If index = -3 Then rawye = "”дѕ «бё—«Ѕ«  «бЏ‘—"
        If index = -4 Then rawye = "”дѕ ё—«Ѕ«  √еб «б’б…"
        If index = -5 Then rawye = "”дѕ «бё—«Ѕ«  «б”»Џ"
        If index = 1 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / д«ЁЏ"
        If index = 2 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / «»д яЋн—"
        If index = 3 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / √»ж Џг—ж «б»’—м"
        If index = 4 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / «»д Џ«г—"
        If index = 5 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / Џ«’г"
        If index = 6 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / Ќг“…"
        If index = 7 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / «бя”«∆м"
        If index = 8 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / √»ж ћЏЁ—"
        If index = 9 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / нЏёж»"
        If index = 10 Then rawye = "”дѕ ё—«Ѕ… «б≈г«г / ќбЁ «б»“«—"
        If index = 11 Then rawye = "”дѕ —ж«н… / ж—‘"
        If index = 21 Then rawye = "”дѕ —ж«н… / ёд»б"
        If index = 31 Then rawye = "”дѕ —ж«н… / «б”ж”м"
        If index = 41 Then rawye = "”дѕ —ж«н… / «»д –яж«д"
        If index = 51 Then rawye = "”дѕ —ж«н… / ЌЁ’"
        If index = 61 Then rawye = "”дѕ —ж«н… / ќб«ѕ"
        If index = 71 Then rawye = "”дѕ —ж«н… / √»м «бЌ«—Ћ"
        If index = 81 Then rawye = "”дѕ —ж«н… / «»д ћг«“"
        If index = 91 Then rawye = "”дѕ —ж«н… / —жЌ"
        If index = 101 Then rawye = "”дѕ —ж«н… / ≈ѕ—н”"
        If index = 12 Then rawye = "”дѕ —ж«н… / ё«бжд"
        If index = 22 Then rawye = "”дѕ —ж«н… / «б»“м"
        If index = 32 Then rawye = "”дѕ —ж«н… / «бѕж—м"
        If index = 42 Then rawye = "”дѕ —ж«н… / е‘«г"
        If index = 52 Then rawye = "”дѕ —ж«н… / ‘Џ»…"
        If index = 62 Then rawye = "”дѕ —ж«н… / ќбЁ"
        If index = 72 Then rawye = "”дѕ —ж«н… / √»ж Џг—ж"
        If index = 82 Then rawye = "”дѕ —ж«н… / «»д ж—ѕ«д"
        If index = 92 Then rawye = "”дѕ —ж«н… / —жн”"
        If index = 102 Then rawye = "”дѕ —ж«н… / «бж—«ё"

End Function

Public Function get_sheikh_type() As Integer
    If OptionButton4.Value = True Then
        ' female
        get_sheikh_type = 1
    Else
        get_sheikh_type = -1
    End If
End Function
Public Function get_student_type() As Boolean
    If OptionButton6.Value = True Then
        'female
        get_student_type = False
    Else
        get_student_type = True
    End If
End Function
Public Function get_status() As String
 ' set egaza status
    If CheckBox39.Value = True Then
        get_status = "«ќ »«—«"
    End If
    
    If CheckBox40.Value = True Then
        get_status = "»Џ÷ «бё—«д"
    Else
        get_status = "ќ г… я«гб…"
    End If
       
    If CheckBox41.Value = True Then
        get_status = get_status + " " + "дў—« гд «бг’ЌЁ"
    Else
        get_status = get_status + " " + "џн»« Џд ўе— ёб»"
    End If
   
End Function
Public Function get_index() As Integer
 ' set index

    If CheckBox38.Value = True Then
        ' «б”»Џ
        get_index = -5
    End If
    
    If CheckBox6.Value = True Then
        ' «еб «б’б…
        get_index = -4
    End If
    
    If CheckBox37.Value = True Then
         ' «бЏ‘—
         get_index = -3
    End If
    
    If CheckBox42.Value = True Then
         ' «б»’—н«д
         get_index = -2
    End If
    
    If CheckBox5.Value = True Then
        ' «б ж”Ў
        get_index = -1
    End If
    
    If CheckBox7.Value = True Then
        'д«ЁЏ
        get_index = 1
    End If
    
    If CheckBox8.Value = True Then
        '«»д яЋн—
        get_index = 2
    End If
   
    If CheckBox9.Value = True Then
        '«»ж Џг—ж
        get_index = 3
    End If
   
    If CheckBox10.Value = True Then
       '«»д Џ«г—
        get_index = 4
    End If
     
    If CheckBox11.Value = True Then
       'Џ«’г
        get_index = 5
    End If
     
    If CheckBox12.Value = True Then
       'Ќг“…
        get_index = 6
    End If
     
    If CheckBox13.Value = True Then
       '«бя”«∆м
        get_index = 7
    End If
     
    If CheckBox14.Value = True Then
        '«»ж ћЏЁ—
         get_index = 8
    End If
   
    If CheckBox15.Value = True Then
       'нЏёж»
        get_index = 9
    End If
     
    If CheckBox16.Value = True Then
        'ќбЁ
         get_index = 10
    End If
   
    ' set Rowayat
    If CheckBox17.Value = True Then
        'ж—‘
        get_index = 11
    End If
   
    If CheckBox18.Value = True Then
        'ё«бжд
        get_index = 12
    End If
    
    If CheckBox19.Value = True Then
        'ёд»б
         get_index = 21
    End If
     
    If CheckBox20.Value = True Then
        '«б»“м
         get_index = 22
    End If
     
    If CheckBox21.Value = True Then
        '«б”ж”м
         get_index = 31
    End If
    
    If CheckBox22.Value = True Then
       '«бѕж—м
       get_index = 32
    End If
     
    If CheckBox23.Value = True Then
     '«»д –яж«д
     get_index = 41
    End If
    
    If CheckBox24.Value = True Then
      'е‘«г Џд «»д Џ«г—
      get_index = 42
    End If
     
    If CheckBox25.Value = True Then
     'ЌЁ’
     get_index = 51
    End If
     
    If CheckBox26.Value = True Then
    '‘Џ»…
    get_index = 52
    End If
   
    If CheckBox27.Value = True Then
     'ќб«ѕ
     get_index = 61
    End If
     
    If CheckBox28.Value = True Then
      'ќбЁ
      get_index = 62
    End If
     
    If CheckBox29.Value = True Then
       '«»м «бЌ«—Ћ
       get_index = 71
    End If
     
    If CheckBox30.Value = True Then
        '«бѕж—м Џд «дя”«м∆
        get_index = 72
    End If
     
    If CheckBox31.Value = True Then
    '«»д ћг«“
    get_index = 81
    End If
     
    If CheckBox32.Value = True Then
     '«»д ж—ѕ«д
     get_index = 82
    End If
     
    If CheckBox33.Value = True Then
      '—жЌ
      get_index = 91
    End If
     
    If CheckBox34.Value = True Then
       '—жн”
       get_index = 92
    End If
     
    If CheckBox35.Value = True Then
       '«ѕ—н”
         get_index = 101
    End If
     
    If CheckBox36.Value = True Then
        '«бж—«ё
         get_index = 102
    End If

End Function

Public Function get_special_index(QERAA As String) As Integer
 ' set index

    If InStr(QERAA, "«б”»Џ") > 0 Then
        '«б”»Џ
        get_special_index = -5
    End If
    
    If InStr(QERAA, "«еб «б’б…") > 0 Then
        ' «еб «б’б…
        get_special_index = -4
    End If
    
   If InStr(QERAA, "«бЏ‘—") > 0 Then
          ' «бЏ‘—
         get_special_index = -3
    End If
    
   If InStr(QERAA, "«б»’—н«д") > 0 Then
          ' «б»’—н«д
         get_special_index = -2
    End If
    
   If InStr(QERAA, "«б ж”Ў") > 0 Then
         ' «б ж”Ў
        get_special_index = -1
    End If
    
   If InStr(QERAA, "д«ЁЏ") > 0 Then
         'д«ЁЏ
        get_special_index = 1
    End If
    
   If InStr(QERAA, "яЋн—") > 0 Then
         '«»д яЋн—
        get_special_index = 2
    End If
   
   If InStr(QERAA, "«»ж Џг—ж") > 0 Then
         '«»ж Џг—ж
        get_special_index = 3
    End If
   
   If InStr(QERAA, "«»д Џ«г—") > 0 Then
        '«»д Џ«г—
        get_special_index = 4
    End If
     
   If InStr(QERAA, "Џ«’г") > 0 Then
        'Џ«’г
        get_special_index = 5
    End If
     
   If InStr(QERAA, "Ќг“…") > 0 Then
        'Ќг“…
        get_special_index = 6
    End If
     
   If InStr(QERAA, "«бя”«∆м") > 0 Then
        '«бя”«∆м
        get_special_index = 7
    End If
     
   If InStr(QERAA, "«»ж ћЏЁ—") > 0 Then
         '«»ж ћЏЁ—
         get_special_index = 8
    End If
   
   If InStr(QERAA, "нЏёж»") > 0 Then
        'нЏёж»
        get_special_index = 9
    End If
     
   If InStr(QERAA, "ќбЁ «бЏ«‘—") > 0 Then
         'ќбЁ «бЏ«‘—
         get_special_index = 10
    End If
   
    ' set Rowayat
   If InStr(QERAA, "ж—‘") > 0 Then
         'ж—‘
        get_special_index = 11
    End If
   
   If InStr(QERAA, "ё«бжд") > 0 Then
         'ё«бжд
        get_special_index = 12
    End If
    
   If InStr(QERAA, "ёд»б") > 0 Then
         'ёд»б
         get_special_index = 21
    End If
     
   If InStr(QERAA, "«б»“м") > 0 Then
         '«б»“м
         get_special_index = 22
    End If
     
   If InStr(QERAA, "«б”ж”м") > 0 Then
         '«б”ж”м
         get_special_index = 31
    End If
    
   If InStr(QERAA, "«бѕж—н") > 0 Then
        '«бѕж—м
       get_special_index = 32
    End If
     
   If InStr(QERAA, "«»д –яж«д") > 0 Then
      '«»д –яж«д
     get_special_index = 41
    End If
    
   If InStr(QERAA, "е‘«г") > 0 Then
       'е‘«г Џд «»д Џ«г—
      get_special_index = 42
    End If
     
   If InStr(QERAA, "ЌЁ’") > 0 Then
      'ЌЁ’
     get_special_index = 51
    End If
     
   If InStr(QERAA, "‘Џ»…") > 0 Then
     '‘Џ»…
    get_special_index = 52
    End If
   
   If InStr(QERAA, "ќб«ѕ") > 0 Then
      'ќб«ѕ
     get_special_index = 61
    End If
     
   If InStr(QERAA, "ќбЁ") > 0 Then
       'ќбЁ
      get_special_index = 62
    End If
     
   If InStr(QERAA, "«»м «бЌ«—Ћ") > 0 Then
        '«»м «бЌ«—Ћ
       get_special_index = 71
    End If
     
   If InStr(QERAA, "«бѕж—м Џд «дя”«м∆") > 0 Then
         '«бѕж—м Џд «дя”«м∆
        get_special_index = 72
    End If
     
   If InStr(QERAA, "«»д ћг«“") > 0 Then
     '«»д ћг«“
    get_special_index = 81
    End If
     
   If InStr(QERAA, "«»д ж—ѕ«д") > 0 Then
      '«»д ж—ѕ«д
     get_special_index = 82
    End If
     
   If InStr(QERAA, "—жЌ") > 0 Then
       '—жЌ
      get_special_index = 91
    End If
     
   If InStr(QERAA, "—жн”") > 0 Then
        '—жн”
       get_special_index = 92
    End If
     
   If InStr(QERAA, "«ѕ—н”") > 0 Then
        '«ѕ—н”
         get_special_index = 101
    End If
     
   If InStr(QERAA, "«бж—«ё") > 0 Then
         '«бж—«ё
         get_special_index = 102
    End If

End Function

Public Function get_tareq() As String
    get_tareq = " гд Ў—нё "
    If CheckBox3.Value = True Then
     
        If CheckBox14.Value = True Or CheckBox15.Value = True Or CheckBox16.Value = True Or CheckBox31.Value = True Or CheckBox32.Value = True Or CheckBox33.Value = True Or CheckBox34.Value = True Or CheckBox35.Value = True Or CheckBox36.Value = True Then
            get_tareq = get_tareq + "«бѕ—…"
        Else
            get_tareq = get_tareq + "«б‘«Ў»н…"
        End If
        
        If CheckBox37.Value = True Or CheckBox42.Value = True Or CheckBox6.Value = True Or CheckBox5.Value = True Then
            get_tareq = " гд Ў—нё «б‘«Ў»н… ж «бѕ—…"
        End If
        
     End If
     
     If CheckBox4.Value = True And CheckBox3.Value = True Then
         get_tareq = get_tareq + " ж «бЎн»…"
     ElseIf CheckBox4.Value = True Then
         get_tareq = get_tareq + "«бЎн»…"
     End If

End Function

Private Sub CommandButton7_Click()
  
   Dim counter As Integer

  For counter = 0 To ListBox1.ListCount - 1
    If ListBox1.Selected(counter) Then
        DB_ejaza_creator (Split(ListBox1.Column(0, counter), "-")(0))
    End If
    Next counter
   
End Sub

Private Sub ComboBox1_Change()
        
   Set rst_object = db_object.OpenRecordset("Select CONTENT.ID , CONTENT.STUDENT_NAME , CONTENT.QERAA from  CONTENT , [ORDER] WHERE  CONTENT.ORDER_ID = [ORDER].ID AND TYPE IN ( 'EJAZA' , 'DSGN' )  AND [ORDER].SHEIKH_NAME = '" & Split(ComboBox1.Value, "-")(1) & "'")
   ListBox1.Clear
      Do Until rst_object.EOF
          ListBox1.AddItem (rst_object.Fields("ID") & "-" & rst_object.Fields("STUDENT_NAME") & "-" & rst_object.Fields("QERAA"))
        rst_object.MoveNext
       Loop

End Sub
Private Function close_db()
  rst_object.Close
  db_object.Close
  Set db_object = Nothing
  Set rst_object = Nothing
End Function
Private Sub CommandButton1_Click()

    Dim index As Integer
    Dim sheikh_type As Integer
    Dim student_type As Boolean
    
    Dim sheikh_name As String
    Dim sheikh_info As String
    Dim student_name As String
    Dim student_info As String
      
    Dim Rng As Range, iPage As Long
    Dim status As String
    Dim qeraat As String
    Dim TAREQ As String
    Dim rawy As String
    Dim sanada As String
     
    sheikh_name = TextBox1.text
    student_name = TextBox2.text
    sheikh_info = TextBox3.text
    student_info = TextBox4.text
   
    sheikh_type = get_sheikh_type()
    student_type = get_student_type()
    status = get_status()
    index = get_index()
      
    If index <> 0 Then
        
        TAREQ = get_tareq()
        sanada = sanadan(index)
        rawy = rawye(index)
        qeraat = qeraatn(index)
        qeraat = qeraat + TAREQ
        rawy = rawy + TAREQ
        
        ActiveDocument.SaveAs2 FileName:=ActiveDocument.path + Application.PathSeparator + student_name + " - " + qeraat + ".docx", FileFormat:= _
         wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
         :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
         :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
         SaveAsAOCELetter:=False, CompatibilityMode:=14
             
        update_sheikh_student sheikh_type:=True, student_type:=True
        set_qeraat STATE:=status, qeraat:=qeraat, rawy:=rawy
        set_snada (sanada)
        Selection.GoTo What:=wdGoToPage, Which:=wdGoToNext, NAME:="1"
        ActiveDocument.Save
        
    End If
    
    Dim tempForm As UserForm1
    For Each tempForm In UserForms
        Unload tempForm
    Next
    
End Sub

Private Sub CommandButton3_Click()
    
    Dim temp As Integer
    Dim index As Integer
    Dim sheikh_type As Integer
    Dim student_type As Boolean
    
    Dim sheikh_name As String
    Dim sheikh_info As String
    Dim student_name As String
    Dim student_info As String
      
    Dim Rng As Range, iPage As Long
    Dim status As String
    Dim qeraat As String
    Dim TAREQ As String
    Dim rawy As String
    Dim sanada As String
     
    Dim originalFilePath As String
    Dim dlgOpen As FileDialog
    Dim IndexArray(30) As Integer
    Dim loop_counter As Integer
    
    IndexArray(1) = 1
    IndexArray(2) = 2
    IndexArray(3) = 3
    IndexArray(4) = 4
    IndexArray(5) = 5
    IndexArray(6) = 6
    IndexArray(7) = 7
    IndexArray(8) = 8
    IndexArray(9) = 9
    IndexArray(10) = 10
    IndexArray(11) = 11
    IndexArray(12) = 21
    IndexArray(13) = 31
    IndexArray(14) = 41
    IndexArray(15) = 51
    IndexArray(16) = 61
    IndexArray(17) = 71
    IndexArray(18) = 81
    IndexArray(19) = 91
    IndexArray(20) = 101
    IndexArray(21) = 12
    IndexArray(22) = 22
    IndexArray(23) = 32
    IndexArray(24) = 42
    IndexArray(25) = 52
    IndexArray(26) = 62
    IndexArray(27) = 72
    IndexArray(28) = 82
    IndexArray(29) = 92
    IndexArray(30) = 102
    loop_counter = 1
    
temp = MsgBox("Start group!", vbQuestion + vbYesNo, "Confirm")

If temp = 6 Then
   
    Set dlgOpen = Application.FileDialog(FileDialogType:=msoFileDialogOpen)
    With dlgOpen
    .AllowMultiSelect = False
    .Show
    End With
    originalFilePath = dlgOpen.SelectedItems(1)
          
    sheikh_name = TextBox1.text
    student_name = TextBox2.text
    sheikh_info = TextBox3.text
    student_info = TextBox4.text
     
    sheikh_type = get_sheikh_type()
    student_type = get_student_type()
    status = get_status()
    
    Set wdApp = GetObject(, "Word.Application")
                   
  While loop_counter <= 30
    
     index = IndexArray(loop_counter)
     TAREQ = get_tareq()
     sanada = sanadan(index)
     rawy = rawye(index)
     qeraat = qeraatn(index)
     qeraat = qeraat + TAREQ
     rawy = rawy + TAREQ
 
     Documents.Open FileName:=originalFilePath, ReadOnly:=False
   
     ActiveDocument.SaveAs2 FileName:=ActiveDocument.path + Application.PathSeparator + Replace(rawy, "/", "") + ".docx", FileFormat:= _
     wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
     :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
     :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
     SaveAsAOCELetter:=False, CompatibilityMode:=14
        
     update_sheikh_student
     set_qeraat STATE:=status, qeraat:=qeraat, rawy:=rawy
     set_snada (sanada)
        
     ActiveDocument.Save
     wdApp.Documents(ActiveDocument.path + Application.PathSeparator + Replace(rawy, "/", "") + ".docx").Close
     
     loop_counter = loop_counter + 1
     
  Wend
       
    Dim tempForm As UserForm
    For Each tempForm In UserForms
        Unload tempForm
    Next

End If

End Sub
Private Sub DB_ejaza_finish()
    Selection.GoTo What:=wdGoToPage, Which:=wdGoToNext, NAME:="1"
        Dim tempForm As UserForm1
        For Each tempForm In UserForms
            Unload tempForm
            Dim x As Integer
        Next
       ActiveDocument.Save
End Sub
Private Sub DB_ejaza_creator(ejaza_id As String)

   Dim db As DAO.Database
   Dim rst As DAO.Recordset
    
   Dim NAME As String
   Dim INFO As String
   Dim QERAA As String
   Dim TAREk As String
   Dim STATE As String
   Dim GENDER As Boolean
   
   Set db = OpenDatabase(database_path)
   Set rst = db.OpenRecordset("Select * from CONTENT where ID = " & ejaza_id)
       
   If rst.RecordCount > 0 Then
      
      NAME = rst.Fields("STUDENT_NAME")
      QERAA = rst.Fields("QERAA")
      TAREk = rst.Fields("TAREQ")
      STATE = rst.Fields("STATE")
      INFO = rst.Fields("STUDENT_INFO")
      
      If (rst.Fields("STUDENT_GENDER") = "Ў«б»…") Then
        GENDER = False
      Else
        GENDER = True
      End If
      
      TextBox5.text = NAME & vbNewLine & INFO & vbNewLine & rst.Fields("STUDENT_GENDER") & vbNewLine & QERAA & vbNewLine & TAREk & vbNewLine & STATE
   Else
      TextBox5.text = "гЏ—Ё «б≈ћ«“… џн— гжћжѕ"
      GoTo endF:
   End If
   
   
    Dim sheikh_type As Integer
    Dim sheikh_name As String
    Dim sheikh_info As String
        
    Dim student_type As Boolean
    Dim student_name As String
    Dim student_info As String
         
    Dim Rng As Range, iPage As Long
    Dim rawy As String
    Dim sanada As String
         
    Dim index As Integer
    Dim status As String
    Dim qeraat As String
    Dim TAREQ As String
    Dim short_name As String
      
    sheikh_name = TextBox1.text
    sheikh_info = TextBox3.text
    sheikh_type = get_sheikh_type()
     
    student_name = NAME
    TextBox2.text = NAME
    student_info = INFO
    student_type = GENDER
    TextBox4.text = INFO
    
    short_name = Split(student_name, " ")(0) + " " + Split(student_name, " ")(1) + " " + Split(student_name, " ")(2)
     
    index = get_special_index(QERAA)
     
   ' set egaza status
    If InStr(STATE, "«ќ »«—«") > 0 Then
        status = "«ќ »«—«"
    ElseIf InStr(STATE, "»Џ÷") > 0 Then
        status = "»Џ÷ «бё—¬д"
    ElseIf InStr(STATE, "ќ г…") > 0 Then
        status = "ќ г… я«гб…"
    Else
        status = STATE
    End If
    
    If InStr(STATE, "џн»«") > 0 Then
        status = status + " " + "џн»« Џд ўе— ёб»"
    ElseIf InStr(STATE, "дў—«") > 0 Then
        status = status + " " + "дў—« гд «бг’ЌЁ"
    Else
         status = STATE
    End If
    
    
    If InStr(TAREk, "’џ—м") > 0 And index < 0 And index > -5 Then
        TAREQ = " гд Ў—нё «б‘«Ў»н… ж«бѕ—…"
    ElseIf InStr(TAREk, "’џ—м") > 0 And index > 80 And index < 110 Then
        TAREQ = " гд Ў—нё «бѕ—…"
    ElseIf InStr(TAREk, "’џ—м") > 0 And index > 7 And index < 11 Then
        TAREQ = " гд Ў—нё «бѕ—…"
    ElseIf InStr(TAREk, "’џ—м") > 0 Then
        TAREQ = " гд Ў—нё «б‘«Ў»н…"
    ElseIf InStr(TAREk, "я»—м") > 0 Then
        TAREQ = " гд Ў—нё «бЎн»…"
    Else
        TAREQ = TAREk
    End If

    
    sanada = sanadan(index)
    rawy = rawye(index)
    qeraat = qeraatn(index)
    
    qeraat = qeraat + TAREQ
    rawy = rawy + TAREQ
      
    createWord (ActiveDocument.path + Application.PathSeparator + short_name + " - " + QERAA + ".docx")
    update_sheikh_student sheikh_type:=True, student_type:=GENDER
    set_qeraat STATE:=status, qeraat:=qeraat, rawy:=rawy
    set_snada (sanada)
          
    If CheckBox43.Value = False Then
        PdfSaving
        sampleSaving
    End If
    
    closeWord (ActiveDocument.path + Application.PathSeparator + short_name + " - " + QERAA + ".docx")
    
endF:
End Sub
Private Sub closeWord(filePath As String)
 
    Set wdApp = GetObject(, "Word.Application")
    ActiveDocument.Save
    wdApp.Documents(filePath).Close
    Documents.Open FileName:=ActiveDocument.path + Application.PathSeparator + "temp.docx", ReadOnly:=False
  
End Sub

Private Sub createWord(filePath As String)
 
   ActiveDocument.SaveAs2 FileName:=filePath, FileFormat:= _
         wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
         :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
         :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
         SaveAsAOCELetter:=False, CompatibilityMode:=14
    
   ActiveDocument.SaveAs2 FileName:=ActiveDocument.path + Application.PathSeparator + "temp.docx", FileFormat:= _
         wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
         :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
         :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
         SaveAsAOCELetter:=False, CompatibilityMode:=14
       
    Documents.Open FileName:=filePath, ReadOnly:=False
   
End Sub
Private Sub CommandButton6_Click()
   
    Dim sheikh_type As Integer
    Dim sheikh_name As String
    Dim sheikh_info As String
        
    Dim Rng As Range, iPage As Long
    Dim rawy As String
    Dim sanada As String
         
    Dim index As Integer
    Dim student_type As Boolean
    Dim student_name As String
    Dim student_info As String
    Dim status As String
    Dim qeraat As String
    Dim TAREQ As String
       
      
    sheikh_name = TextBox1.text
    sheikh_info = TextBox3.text
    sheikh_type = get_sheikh_type()
     
    student_name = "«”г «бЎ«б» ед«"
    student_info = "»н«д«  «бЎ«б» ед«"
    student_type = GENDER
     
    ActiveDocument.SaveAs2 FileName:=ActiveDocument.path + Application.PathSeparator + "sample.docx", FileFormat:= _
    wdFormatXMLDocument, LockComments:=False, Password:="", AddToRecentFiles _
    :=True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts _
    :=False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
    SaveAsAOCELetter:=False, CompatibilityMode:=14
    
    update_sheikh_student sheikh_type:=True, student_type:=True
    index = get_special_index("ЌЁ’")
    
    status = "ќ г… я«гб…"
    status = status + " " + "џн»« Џд ўе— ёб»"
    TAREQ = " гд Ў—нё «б‘«Ў»н…"
    
    sanada = sanadan(index)
    rawy = rawye(index)
    qeraat = qeraatn(index)
    qeraat = qeraat + TAREQ
    rawy = rawy + TAREQ
    set_qeraat STATE:=status, qeraat:=qeraat, rawy:=rawy
    set_snada (sanada)
        
    Selection.GoTo What:=wdGoToPage, Which:=wdGoToNext, NAME:="1"
    Dim tempForm As UserForm1
    For Each tempForm In UserForms
        Unload tempForm
    Next
   ActiveDocument.Save

End Sub

Private Sub OptionButton3_Click()
 TextBox3.text = "гё—∆ жгЏбг «бё—¬д «бя—нг ж«б ћжнѕ"
End Sub

Private Sub OptionButton4_Click()
 TextBox3.text = "гё—∆… жгЏбг… «бё—¬д «бя—нг ж«б ћжнѕ"
End Sub

Sub PdfSaving()
    Dim FileName As String
    FileName = Split(ActiveDocument.NAME, ".", 2)(i)
    ActiveDocument.ExportAsFixedFormat OutputFileName:= _
        ActiveDocument.path + Application.PathSeparator + FileName + ".pdf", ExportFormat:=wdExportFormatPDF, _
        OpenAfterExport:=False, OptimizeFor:=wdExportOptimizeForPrint, Range:= _
        wdExportAllDocument, From:=1, To:=1, Item:=wdExportDocumentContent, _
        IncludeDocProps:=True, KeepIRM:=True, CreateBookmarks:= _
        wdExportCreateNoBookmarks, DocStructureTags:=True, BitmapMissingFonts:= _
        True, UseISO19005_1:=False

End Sub
Sub sampleSaving()
    Dim FileName As String
    FileName = Split(ActiveDocument.NAME, ".", 2)(i)
    ActiveDocument.ExportAsFixedFormat OutputFileName:= _
        "E:\other\print\smpl" + Application.PathSeparator + "smpl-" + FileName + ".pdf", ExportFormat:=wdExportFormatPDF, _
        OpenAfterExport:=False, OptimizeFor:=wdExportOptimizeForOnScreen, Range:= _
        wdExportAllDocument, From:=1, To:=1, Item:=wdExportDocumentContent, _
        IncludeDocProps:=True, KeepIRM:=True, CreateBookmarks:= _
        wdExportCreateNoBookmarks, DocStructureTags:=True, BitmapMissingFonts:= _
        True, UseISO19005_1:=False
End Sub
